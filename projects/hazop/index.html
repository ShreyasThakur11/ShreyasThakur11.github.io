<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI HAZOP Assistant | Shreyas Thakur</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../style.css">

    <style>
        .hazop-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 5%;
        }

        .risk-badge {
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-weight: 600;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .risk-high {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid #ef4444;
        }

        .risk-medium {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
            border: 1px solid #f59e0b;
        }

        .risk-low {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            border: 1px solid #10b981;
        }

        .worksheet-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
            margin-top: 1rem;
        }

        .worksheet-table th {
            background: rgba(30, 41, 59, 0.8);
            text-align: left;
            padding: 1rem;
            border-bottom: 2px solid var(--glass-border);
            color: #94a3b8;
        }

        .worksheet-table td {
            padding: 0.8rem 1rem;
            border-bottom: 1px solid var(--glass-border);
            vertical-align: top;
            color: var(--text-color);
        }

        .node-row {
            background: rgba(56, 189, 248, 0.05);
            font-weight: bold;
        }

        .input-section {
            background: rgba(30, 41, 59, 0.6);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .sample-btn {
            background: rgba(148, 163, 184, 0.1);
            border: 1px solid rgba(148, 163, 184, 0.3);
            color: #cbd5e1;
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            margin-right: 0.5rem;
        }

        .sample-btn:hover {
            background: rgba(148, 163, 184, 0.2);
        }
    </style>
</head>

<body>
    <nav>
        <a href="../../index.html" class="logo">Shreyas</a>
        <div class="nav-links">
            <a href="../../index.html">Home</a>
            <a href="../../index.html#projects" class="active">Projects</a>
            <a href="../../contact.html">Comm Link</a>
        </div>
    </nav>

    <main class="hazop-container">
        <header class="project-header">
            <div style="margin-bottom: 1rem; font-size: 0.9rem;">
                <a href="../../index.html#projects" style="color: var(--secondary-color); text-decoration: none;">&larr;
                    Back to Projects</a>
            </div>
            <h1>AI Safety & HAZOP Assistant</h1>
            <p>Automated Process Hazard Analysis using Expert Systems</p>
        </header>

        <!-- Input -->
        <div class="input-section">
            <h3><span class="icon">üîç</span> Describe Process Node</h3>
            <p style="color:#94a3b8; margin-bottom:1rem; font-size:0.9rem;">
                Enter a process description. The AI will extract nodes (Reactors, Pumps, Columns) and generate a HAZOP
                study.
            </p>

            <div style="margin-bottom:1rem;">
                <button class="sample-btn"
                    onclick="loadSample('Exothermic CSTR with cooling jacket and feed pump')">Exothermic
                    Reactor</button>
                <button class="sample-btn"
                    onclick="loadSample('High pressure distillation column with reflux drum')">Distillation
                    Column</button>
                <button class="sample-btn" onclick="loadSample('Storage tank with centrifugal pump')">Storage
                    Tank</button>
            </div>

            <textarea id="processText"
                style="width:100%; height:100px; background:rgba(15,23,42,0.8); border:1px solid var(--glass-border); border-radius:8px; padding:1rem; color:white; font-family:'Inter';"
                placeholder="e.g. Continuous Stirred Tank Reactor (CSTR) fed by a centrifugal pump..."></textarea>

            <button onclick="runHAZOP()" class="cta-button primary full-width" style="margin-top:1rem;">Run HAZOP
                Analysis ‚ö†Ô∏è</button>
        </div>

        <!-- Matrix & Stats -->
        <div id="dashboard" style="display:none; grid-template-columns: 1fr 1fr 1fr; gap:1rem; margin-bottom:2rem;">
            <div class="card" style="text-align:center;">
                <h4 style="color:#ef4444;">High Risks</h4>
                <div style="font-size:2rem; font-weight:bold;" id="count-high">0</div>
            </div>
            <div class="card" style="text-align:center;">
                <h4 style="color:#f59e0b;">Medium Risks</h4>
                <div style="font-size:2rem; font-weight:bold;" id="count-med">0</div>
            </div>
            <div class="card" style="text-align:center;">
                <h4 style="color:#10b981;">Low Risks</h4>
                <div style="font-size:2rem; font-weight:bold;" id="count-low">0</div>
            </div>
        </div>

        <!-- Output Table -->
        <div id="worksheet-panel" class="card hidden">
            <div style="display:flex; justify-content:space-between; align-items:center;">
                <h3>HAZOP Worksheet</h3>
                <button class="cta-button secondary small" onclick="alert('Export feature coming soon!')">Export
                    PDF</button>
            </div>

            <div style="overflow-x:auto;">
                <table class="worksheet-table">
                    <thead>
                        <tr>
                            <th style="width:10%;">Node</th>
                            <th style="width:15%;">Deviation</th>
                            <th style="width:20%;">Potential Causes</th>
                            <th style="width:20%;">Consequences</th>
                            <th style="width:20%;">Safeguards</th>
                            <th style="width:10%;">Risk</th>
                        </tr>
                    </thead>
                    <tbody id="hazop-body">
                        <!-- JS Populated -->
                    </tbody>
                </table>
            </div>
        </div>

    </main>

    <script src="script.js"></script>
    <script>
        const engine = new HAZOPEngine();

        function loadSample(text) {
            document.getElementById('processText').value = text;
        }

        function runHAZOP() {
            const text = document.getElementById('processText').value;
            if (!text) return;

            const results = engine.generateStudy(text);
            const tbody = document.getElementById('hazop-body');
            tbody.innerHTML = '';

            let high = 0, med = 0, low = 0;

            // Group by Node Name for cleaner UI? 
            // Or just list. Let's list but maybe highlight node changes.

            results.forEach(row => {
                const tr = document.createElement('tr');

                let riskClass = 'risk-low';
                if (row.risk === 'High') { riskClass = 'risk-high'; high++; }
                else if (row.risk === 'Medium') { riskClass = 'risk-medium'; med++; }
                else low++;

                tr.innerHTML = `
                    <td><strong>${row.node}</strong><br><span style="font-size:0.8rem; color:#64748b">${row.param}</span></td>
                    <td>${row.deviation}</td>
                    <td>${row.causes}</td>
                    <td>${row.consequences}</td>
                    <td>${row.safeguards}</td>
                    <td><span class="risk-badge ${riskClass}">${row.risk}</span></td>
                `;
                tbody.appendChild(tr);
            });

            document.getElementById('worksheet-panel').classList.remove('hidden');

            // Update Dashboard
            document.getElementById('dashboard').style.display = 'grid';
            document.getElementById('count-high').textContent = high;
            document.getElementById('count-med').textContent = med;
            document.getElementById('count-low').textContent = low;
        }
    </script>
</body>

</html>